
# P20 - Serial Adder —á–µ—Ä–µ–∑ –∫–æ–Ω–µ—á–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç (FSM)

## –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç **P20** –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é **–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–≥–æ 4-–±–∏—Ç–Ω–æ–≥–æ —Å—É–º–º–∞—Ç–æ—Ä–∞**
(*bit-serial adder*) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **–∫–æ–Ω–µ—á–Ω–æ–≥–æ –∞–≤—Ç–æ–º–∞—Ç–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π (FSM)**.

–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –ø—Ä–æ–µ–∫—Ç–∞ **P19**, –≥–¥–µ –ª–æ–≥–∏–∫–∞ –±—ã–ª–∞ –æ–ø–∏—Å–∞–Ω–∞ –Ω–∞–ø—Ä—è–º—É—é, –≤ P20 –∞–ª–≥–æ—Ä–∏—Ç–º
—Å–ª–æ–∂–µ–Ω–∏—è –æ—Ñ–æ—Ä–º–ª–µ–Ω –∫–∞–∫ **FSM + datapath**, —á—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–º—É
–∏–Ω–∂–µ–Ω–µ—Ä–Ω–æ–º—É –ø–æ–¥—Ö–æ–¥—É –∫ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—é —Ü–∏—Ñ—Ä–æ–≤—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤.

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è:

* –∏–∑—É—á–µ–Ω–∏—è –∫–æ–Ω–µ—á–Ω—ã—Ö –∞–≤—Ç–æ–º–∞—Ç–æ–≤;
* –ø–æ–Ω–∏–º–∞–Ω–∏—è –ø–æ—à–∞–≥–æ–≤–æ–≥–æ —Å–ª–æ–∂–µ–Ω–∏—è —Å –ø–µ—Ä–µ–Ω–æ—Å–æ–º;
* –∞–Ω–∞–ª–∏–∑–∞ —Ä–∞–±–æ—Ç—ã FSM –≤ —Å–∏–º—É–ª—è—Ç–æ—Ä–µ **ISim**.

üé¨ –í–∏–¥–µ–æ (#28): https://youtu.be/UeRZQ6TJnVE

---

## –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü—Ä–æ–µ–∫—Ç —Ä–∞–∑–¥–µ–ª—ë–Ω –Ω–∞ –¥–≤–µ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ —á–∞—Å—Ç–∏:

### 1. FSM (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)

FSM –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π:

* –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö,
* –æ–∂–∏–¥–∞–Ω–∏–µ —à–∞–≥–∞,
* —Å–ª–æ–∂–µ–Ω–∏–µ –±–∏—Ç–∞,
* —Å–¥–≤–∏–≥,
* –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è.

### 2. Datapath (–¥–∞–Ω–Ω—ã–µ)

Datapath —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ–≥–∏—Å—Ç—Ä—ã –∏ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—É—é —á–∞—Å—Ç—å:

* `a_reg`, `b_reg` - —Å–¥–≤–∏–≥–∞–µ–º—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã –≤—Ö–æ–¥–Ω—ã—Ö —á–∏—Å–µ–ª;
* `sum_reg` - —Ä–µ–≥–∏—Å—Ç—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞;
* `carry` - –ø–µ—Ä–µ–Ω–æ—Å –º–µ–∂–¥—É –±–∏—Ç–∞–º–∏;
* `bit_idx` - –Ω–æ–º–µ—Ä —Ç–µ–∫—É—â–µ–≥–æ –±–∏—Ç–∞.

---

## –°–æ—Å—Ç–æ—è–Ω–∏—è FSM

* **ST_IDLE** - –æ–∂–∏–¥–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã –∑–∞–≥—Ä—É–∑–∫–∏
* **ST_LOAD** - –∑–∞–≥—Ä—É–∑–∫–∞ –≤—Ö–æ–¥–Ω—ã—Ö —á–∏—Å–µ–ª A –∏ B, —Å–±—Ä–æ—Å —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤
* **ST_ADD** - —Å–ª–æ–∂–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –±–∏—Ç–∞ (full adder), –ø–æ —Å–∏–≥–Ω–∞–ª—É STEP
* **ST_SHIFT** - —Å–¥–≤–∏–≥ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ A –∏ B –≤–ø—Ä–∞–≤–æ
* **ST_CHECK** - —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–∞ –±–∏—Ç–∞ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è
* **ST_DONE** - –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

---

## –î–∏–∞–≥—Ä–∞–º–º–∞ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ FSM

```text
            +---------+
            | ST_IDLE |
            +---------+
                 |
            LOAD | BTN3
                 v
            +---------+
            | ST_LOAD |
            +---------+
                 |
                 v
            +---------+
            | ST_ADD  |  <-- BTN0 (STEP)
            +---------+
                 |
                 v
            +---------+
            | ST_SHIFT|
            +---------+
                 |
                 v
            +---------+
            | ST_CHECK|
            +---------+
             |       |
   bit < N-1 |       | bit = N-1
             v       v
         ST_ADD   +---------+
                  | ST_DONE |
                  +---------+
                       |
                  LOAD | BTN3
                       v
                    ST_LOAD
```

---

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ –∏–Ω–¥–∏–∫–∞—Ü–∏—è (Basys 2)

### –í—Ö–æ–¥—ã

* **SW0-SW3** - —á–∏—Å–ª–æ **A**
* **SW4-SW7** - —á–∏—Å–ª–æ **B**
* **BTN3** - `LOAD / RESET`
* **BTN0** - `STEP` (–æ–¥–∏–Ω –±–∏—Ç —Å–ª–æ–∂–µ–Ω–∏—è)

### –í—ã—Ö–æ–¥—ã (LED)

* **LED0-LED3** - `SUM[3:0]` (—Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–ª–æ–∂–µ–Ω–∏—è)
* **LED4** - `COUT` (–ø–µ—Ä–µ–Ω–æ—Å –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è)
* **LED5-LED7** - `bit_idx` (–Ω–æ–º–µ—Ä —Ç–µ–∫—É—â–µ–≥–æ –±–∏—Ç–∞)

‚ö†Ô∏è **–í–∞–∂–Ω–æ:**
LED –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç **–Ω–µ —Ç–æ–ª—å–∫–æ —Å—É–º–º—É**, –Ω–æ –∏ —Å–ª—É–∂–µ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é FSM.

---

## –ü–æ—á–µ–º—É –Ω–∞ LED –ø–æ–ª—É—á–∞–µ—Ç—Å—è `0x88`

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø—Ä–∏–º–µ—Ä:

* A = 3 ‚Üí `0011`
* B = 5 ‚Üí `0101`
* –†–µ–∑—É–ª—å—Ç–∞—Ç: `SUM = 8 ‚Üí 1000`

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–ª–æ–∂–µ–Ω–∏—è:

* `LED3..LED0 = 1000` ‚Üí —Å—É–º–º–∞ = **8**
* `bit_idx = 4` (–≤—ã—à–ª–∏ –∑–∞ —Å—Ç–∞—Ä—à–∏–π –±–∏—Ç)

  * `bit_idx = 100‚ÇÇ`
  * `LED7..LED5 = 100`
* `LED4 = 0` (–ø–µ—Ä–µ–Ω–æ—Å –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç)

–ü–æ–ª–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å–≤–µ—Ç–æ–¥–∏–æ–¥–æ–≤:

```
LED7..LED0 = 100 0 1000 = 1000_1000‚ÇÇ = 0x88
```

üëâ **–≠—Ç–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ.**
–ß–∏—Å–ª–æ `0x88` –æ–∑–Ω–∞—á–∞–µ—Ç:

* —Å—É–º–º–∞ = **8**
* FSM –∑–∞–≤–µ—Ä—à–∏–ª –æ–±—Ä–∞–±–æ—Ç–∫—É –≤—Å–µ—Ö 4 –±–∏—Ç.

---

## –ü–æ—à–∞–≥–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã

### –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

* A = 3 (`0011`)
* B = 5 (`0101`)

### –®–∞–≥ 1 - –∑–∞–≥—Ä—É–∑–∫–∞

* –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏
* –ù–∞–∂–∞—Ç—å **BTN3 (LOAD)**
  FSM: `ST_IDLE ‚Üí ST_LOAD ‚Üí ST_ADD`
  LED: `0000`

---

### –®–∞–≥–∏ 2-5 - —Å–ª–æ–∂–µ–Ω–∏–µ –ø–æ –±–∏—Ç–∞–º

–ö–∞–∂–¥–æ–µ –Ω–∞–∂–∞—Ç–∏–µ **BTN0 (STEP)** –∑–∞–ø—É—Å–∫–∞–µ—Ç –æ–¥–∏–Ω —Ü–∏–∫–ª FSM:

```
ST_ADD ‚Üí ST_SHIFT ‚Üí ST_CHECK ‚Üí ST_ADD
```

| –®–∞–≥ | bit_idx | SUM –Ω–∞ LED |
| --: | ------: | ---------- |
|   1 |       0 | 0000       |
|   2 |       1 | 0000       |
|   3 |       2 | 0000       |
|   4 |       3 | 1000       |

–ü–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —à–∞–≥–∞ FSM –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ **ST_DONE**.

---

## –°–∏–º—É–ª—è—Ü–∏—è –≤ ISim

–í —Å–∏–º—É–ª—è—Ü–∏–∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å —Å–∏–≥–Ω–∞–ª—ã:

* `state`  ‚úÖ
* `bit_idx`
* `a_reg`, `b_reg`
* `sum_reg`
* `carry`

–°–æ—Å—Ç–æ—è–Ω–∏—è FSM –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è **–ø–æ –∏–º–µ–Ω–∞–º**, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–≥–ª—è–¥–Ω–æ —É–≤–∏–¥–µ—Ç—å:

```
ST_ADD ‚Üí ST_SHIFT ‚Üí ST_CHECK ‚Üí ST_ADD ‚Üí ‚Ä¶ ‚Üí ST_DONE
```

---

## –°–≤—è–∑—å —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏

* **P19** - –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π —Å—É–º–º–∞—Ç–æ—Ä –±–µ–∑ FSM
* **P20** - —Ç–∞ –∂–µ –∑–∞–¥–∞—á–∞, –Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω–∞—è –∫–∞–∫ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π **–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä FSM**

–ü—Ä–æ–µ–∫—Ç P20 —è–≤–ª—è–µ—Ç—Å—è –ª–æ–≥–∏—á–µ—Å–∫–∏–º –∏ –º–µ—Ç–æ–¥–∏—á–µ—Å–∫–∏–º –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ–º P19 –∏ —Å–ª—É–∂–∏—Ç
–ø–µ—Ä–µ—Ö–æ–¥–æ–º –∫ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–º —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤—ã–º –∏ —É–ø—Ä–∞–≤–ª—è—é—â–∏–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º.

---

[![–í–∏–¥–µ–æ #28](https://img.youtube.com/vi/UeRZQ6TJnVE/maxresdefault.jpg)](https://youtu.be/UeRZQ6TJnVE)